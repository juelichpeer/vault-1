<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VAULT — Admin Dashboard</title>
  <style>
    :root {
      --bg: #0b0f16;
      --card: rgba(255,255,255,0.06);
      --stroke: rgba(255,255,255,0.18);
      --text: #e7ebf3;
      --muted: #a8b0c0;
      --accent: #caa66a;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; color: var(--text);
      font-family: ui-sans-serif, -apple-system, Segoe UI, Roboto, Arial;
      background:
        radial-gradient(1200px 800px at 20% -10%, #1a2233 0%, transparent 60%),
        radial-gradient(900px 600px at 120% 10%, #131a26 0%, transparent 60%),
        var(--bg);
    }
    .shell { min-height: 100%; display: grid; grid-template-rows: auto 1fr; }
    header {
      display:flex; align-items:center; justify-content:space-between;
      padding:16px 20px; border-bottom:1px solid var(--stroke);
      backdrop-filter: blur(10px); background: rgba(255,255,255,0.04);
    }
    .brand { color: var(--accent); letter-spacing:.12em; text-transform:uppercase; font-weight:600; }
    .pill { padding:6px 10px; border:1px solid var(--stroke); border-radius:999px; background:rgba(255,255,255,0.06); font-size:12px; }
    main { padding: 24px; display:grid; gap:20px; grid-template-columns: repeat(auto-fit,minmax(320px,1fr)); }
    .card {
      background: var(--card); border:1px solid var(--stroke);
      border-radius:18px; padding:18px; backdrop-filter: blur(12px);
      box-shadow: 0 10px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.04);
    }
    h2 { margin: 0 0 10px; font-size: 18px; }
    h3 { margin: 10px 0 8px; font-size: 14px; color: var(--muted); letter-spacing:.06em; text-transform: uppercase; }
    button {
      padding:10px 12px; border-radius:12px; border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(202,166,106,0.85), rgba(202,166,106,0.65));
      color:#0b0f16; font-weight:600; cursor:pointer;
    }
    input, select {
      padding:10px 12px; border-radius:12px; border:1px solid var(--stroke);
      background: rgba(255,255,255,0.03); color: var(--text); width: 100%;
    }
    .muted { color: var(--muted); }
    .row { display:flex; gap:10px; align-items:center; }
    .stack { display:grid; gap:10px; }
  </style>
</head>
<body>
  <div class="shell">
    <header>
      <div class="brand">VAULT</div>
      <div class="row">
        <span id="who" class="pill" data-test="current-email">…</span>
        <span id="role" class="pill" data-test="current-role">role: …</span>
        <button id="logoutBtn">Sign out</button>
      </div>
    </header>

    <main>
      <!-- SECTION A -->
      <section class="card" id="section-owner-tools" data-test="section-owner-tools">
        <h2>SECTION A — Owner Tools: Members & Roles</h2>
        <p class="muted">Only the <strong>Owner</strong> can promote or demote users. (Server action coming next.)</p>

        <h3>Target User Email</h3>
        <div class="stack">
          <input id="manageEmail" placeholder="user@example.com" data-test="manage-email" />
          <div class="row">
            <button id="makeAdminBtn" data-test="btn-make-admin">Make admin</button>
            <button id="makeMemberBtn" data-test="btn-make-member">Make member</button>
          </div>
          <small class="muted">Note: UI-only right now; will connect to a secure Netlify Function with service_role.</small>
        </div>
      </section>

      <!-- SECTION B -->
      <section class="card" id="section-members-invites" data-test="section-members-invites">
        <h2>SECTION B — Members & Invites (Magic Links)</h2>
        <p class="muted">Invite users via magic link. Public sign-ups are disabled. (Feature coming next.)</p>
        <div class="stack">
          <input id="inviteEmail" placeholder="newuser@example.com" disabled data-test="invite-email" />
          <button id="inviteBtn" disabled data-test="btn-invite">Invite user (magic link)</button>
        </div>
      </section>

      <!-- SECTION C -->
      <section class="card" id="section-documents" data-test="section-documents">
        <h2>SECTION C — Documents: Buckets, Tags & Secure Shares</h2>
        <p class="muted">Private buckets, per-user access, and temporary share links. (Coming soon.)</p>
        <button disabled data-test="btn-open-docs">Open documents</button>
      </section>

      <!-- SECTION D -->
      <section class="card" id="section-chats" data-test="section-chats">
        <h2>SECTION D — Chats: Direct & Group</h2>
        <p class="muted">Private DMs, group chats, and location tags. (Coming soon.)</p>
        <button disabled data-test="btn-open-chats">Open chats</button>
      </section>

      <!-- SECTION E -->
      <section class="card" id="section-activity" data-test="section-activity">
        <h2>SECTION E — Activity & Notifications</h2>
        <p class="muted">Login/logout and role-change requests are written to the audit log. Toasts show in real time.</p>
        <button disabled data-test="btn-view-audit">View audit log (coming)</button>
      </section>
    </main>
  </div>

  <!-- Load order matters -->
  <script type="module">
    import { requireAdmin } from './authGuard.js';
    import './dashboard.js'; // logic after guard passes
    requireAdmin(); // Gate before anything else
  </script>
</body>
</html>
